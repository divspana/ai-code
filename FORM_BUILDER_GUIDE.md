# 表单设计器使用指南

## 功能概述

表单设计器是一个可视化的拖拽式表单配置工具，让你无需编写代码即可快速创建表单 Schema。

## 界面布局

```
┌─────────────────────────────────────────────────────────────┐
│  📐 表单设计器    [预览] [复制代码] [导出] [导入] [清空]      │
├──────────┬────────────────────────────┬─────────────────────┤
│          │                            │                     │
│  字段组件 │        画布区域             │    属性配置面板      │
│          │                            │                     │
│  📝 文本  │   [拖拽字段到这里]          │   字段名称: ___     │
│  📄 多行  │                            │   字段标签: ___     │
│  🔢 数字  │   [已添加的字段]            │   占位提示: ___     │
│  ⬇️ 下拉  │                            │   ☑ 必填           │
│  ⭕ 单选  │                            │   ☐ 禁用           │
│  ☑️ 多选  │                            │                     │
│  📅 日期  │                            │                     │
│          │                            │                     │
└──────────┴────────────────────────────┴─────────────────────┘
```

## 使用步骤

### 1. 添加字段

**方式一：拖拽添加**

1. 从左侧字段组件面板选择需要的字段类型
2. 按住鼠标左键拖拽到中间画布区域
3. 松开鼠标，字段自动添加到表单中

**方式二：点击添加**（暂未实现）

### 2. 配置字段属性

1. 点击画布中的字段卡片，右侧会显示属性配置面板
2. 可配置的属性包括：
   - **字段名称**：唯一标识符，用于数据绑定
   - **字段标签**：显示给用户的名称
   - **占位提示**：输入框的提示文字
   - **默认值**：字段的初始值
   - **必填**：是否为必填字段
   - **禁用**：是否禁用该字段
   - **只读**：是否为只读状态

### 3. 配置选项（适用于 select/radio/checkbox）

对于下拉选择、单选框、多选框类型的字段：

1. 选中字段后，在右侧配置面板找到"选项配置"
2. 每个选项包含：
   - **标签**：显示给用户的文字
   - **值**：实际提交的数据值
3. 点击"添加选项"按钮可以增加新选项
4. 点击选项右侧的删除按钮可以移除选项

### 4. 调整字段顺序

1. 在画布中按住字段卡片拖拽
2. 移动到目标位置后松开鼠标
3. 字段顺序自动调整

### 5. 复制字段

1. 点击字段卡片右上角的复制图标
2. 系统会在该字段下方创建一个副本
3. 副本的字段名称会自动添加后缀避免冲突

### 6. 删除字段

1. 点击字段卡片右上角的删除图标
2. 字段立即从表单中移除

## 工具栏功能

### 预览模式

- 点击"预览模式"按钮切换到预览视图
- 可以看到表单的实际效果
- 可以测试表单的交互和验证
- 再次点击切换回编辑模式

### 复制代码

- 点击"复制代码"按钮
- Schema JSON 代码会复制到剪贴板
- 可以直接粘贴到代码中使用

### 导出 Schema

- 点击"导出"按钮
- 自动下载 `form-schema.json` 文件
- 文件包含完整的表单配置

### 导入 Schema

- 点击"导入"按钮
- 选择之前导出的 JSON 文件
- 表单配置会自动加载

### 清空表单

- 点击"清空"按钮
- 删除所有字段
- 重新开始设计

## 支持的字段类型

### 1. 文本输入 (Input)

- 单行文本输入框
- 适用于姓名、邮箱、电话等

**可配置属性：**

- 字段名称、标签、占位提示
- 默认值
- 必填、禁用、只读

### 2. 多行文本 (Textarea)

- 多行文本输入框
- 适用于备注、描述等长文本

**可配置属性：**

- 字段名称、标签、占位提示
- 默认值
- 必填、禁用、只读

### 3. 数字输入 (Number)

- 数字输入框，带加减按钮
- 适用于年龄、数量等数值

**可配置属性：**

- 字段名称、标签、占位提示
- 默认值
- 最小值、最大值、步长
- 必填、禁用、只读

### 4. 下拉选择 (Select)

- 下拉选择框
- 适用于单选场景

**可配置属性：**

- 字段名称、标签、占位提示
- 选项列表（标签 + 值）
- 默认值
- 必填、禁用

### 5. 单选框 (Radio)

- 单选按钮组
- 适用于互斥选项

**可配置属性：**

- 字段名称、标签
- 选项列表（标签 + 值）
- 默认值
- 必填、禁用

### 6. 多选框 (Checkbox)

- 多选按钮组
- 适用于多选场景

**可配置属性：**

- 字段名称、标签
- 选项列表（标签 + 值）
- 默认值
- 必填、禁用

### 7. 日期选择 (Date)

- 日期选择器
- 适用于日期输入

**可配置属性：**

- 字段名称、标签、占位提示
- 默认值
- 必填、禁用、只读

## 使用导出的 Schema

### 在代码中使用

```vue
<script setup lang="ts">
import { ref } from 'vue'
import FormEngine from '@/components/FormEngine/FormEngine.vue'
import formSchema from './form-schema.json'

const formData = ref({})
</script>

<template>
  <FormEngine :schema="formSchema" v-model="formData" />
</template>
```

### Schema 格式示例

```json
{
  "fields": [
    {
      "name": "username",
      "label": "用户名",
      "type": "input",
      "required": true,
      "placeholder": "请输入用户名"
    },
    {
      "name": "age",
      "label": "年龄",
      "type": "number",
      "min": 0,
      "max": 150,
      "step": 1
    },
    {
      "name": "gender",
      "label": "性别",
      "type": "radio",
      "options": [
        { "label": "男", "value": "male" },
        { "label": "女", "value": "female" }
      ]
    }
  ]
}
```

## 快捷键（计划中）

- `Ctrl/Cmd + C`：复制选中字段
- `Ctrl/Cmd + V`：粘贴字段
- `Delete`：删除选中字段
- `Ctrl/Cmd + Z`：撤销
- `Ctrl/Cmd + S`：保存/导出

## 最佳实践

### 1. 字段命名规范

- 使用小写字母和下划线：`user_name`
- 使用驼峰命名：`userName`
- 保持简洁且有意义

### 2. 标签文字

- 简洁明了，通常 2-6 个字
- 避免使用专业术语
- 必要时添加说明文字

### 3. 占位提示

- 提供输入示例：`请输入手机号，如：13800138000`
- 说明格式要求：`请输入邮箱地址`
- 不要重复标签文字

### 4. 选项设计

- 选项数量适中（3-8 个为佳）
- 选项互斥且完整
- 考虑添加"其他"选项

### 5. 表单结构

- 相关字段分组
- 重要字段放在前面
- 控制表单长度（不超过 15 个字段）

## 常见问题

### Q: 如何设置字段联动？

A: 当前版本暂不支持在设计器中配置联动，需要在导出后手动添加 `linkage` 配置。

### Q: 可以自定义字段类型吗？

A: 当前支持 7 种基础字段类型，自定义类型需要扩展 FormEngine 组件。

### Q: 导出的 Schema 可以直接用于后端吗？

A: Schema 主要用于前端渲染，后端验证需要单独配置。

### Q: 如何备份我的表单设计？

A: 使用"导出"功能保存 JSON 文件，或使用"复制代码"保存到代码仓库。

### Q: 字段拖拽不生效？

A: 确保浏览器支持 HTML5 拖拽 API，建议使用 Chrome/Edge/Firefox 最新版本。

## 未来计划

- [ ] 字段联动配置界面
- [ ] 表单验证规则配置
- [ ] 表单布局配置（单列/双列/网格）
- [ ] 字段分组和折叠面板
- [ ] 撤销/重做功能
- [ ] 表单模板库
- [ ] 实时协作编辑
- [ ] 表单版本管理

## 技术实现

### 拖拽实现

使用 HTML5 原生 Drag & Drop API：

- `draggable` 属性标记可拖拽元素
- `dragstart` 事件记录拖拽源
- `drop` 事件处理放置逻辑
- `dragover` 事件允许放置

### 数据结构

```typescript
interface FormSchema {
  fields: FieldSchema[]
}

interface FieldSchema {
  name: string
  label: string
  type: string
  required?: boolean
  disabled?: boolean
  readonly?: boolean
  placeholder?: string
  defaultValue?: any
  options?: Array<{ label: string; value: any }>
  min?: number
  max?: number
  step?: number
}
```

### 状态管理

使用 Vue 3 Composition API 的 `ref` 和 `computed` 管理状态：

- `formSchema`：表单配置
- `selectedFieldIndex`：当前选中字段索引
- `previewMode`：预览模式开关

## 相关文档

- [表单引擎使用指南](./FORM_ENGINE_GUIDE.md)
- [项目功能总览](./FEATURES.md)
- [README](./README.md)
