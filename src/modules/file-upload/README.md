# 文件上传模块

## 功能特性

### 📤 上传功能

- **拖拽上传** - 支持拖拽文件到上传区域
- **点击上传** - 点击上传区域选择文件
- **文件夹上传** - 支持选择整个文件夹上传
- **多文件上传** - 同时上传多个文件
- **上传进度** - 实时显示上传进度

### 📋 文件管理

- **列表视图** - 详细的文件列表展示
- **网格视图** - 卡片式网格展示
- **文件筛选** - 按类型筛选（图片、视频、音频、文档、其他）
- **文件预览** - 支持图片和 PDF 预览
- **文件下载** - 单个或批量下载
- **文件删除** - 删除不需要的文件

### 📊 统计分析

- **实时统计** - 文件数量、大小、状态统计
- **类型分布** - 各类型文件数量统计
- **上传状态** - 成功、上传中、失败数量

### ⚙️ 配置选项

- **最大大小限制** - 可配置单文件最大大小
- **数量限制** - 可配置最大文件数量
- **多文件开关** - 控制是否允许多文件上传

## 文件结构

```
file-upload/
├── index.vue          # 主页面
└── README.md          # 说明文档
```

## 路由

- **路径**: `/file-upload`
- **名称**: `FileUpload`

## 支持的文件类型

### 图片

- JPG, JPEG, PNG, GIF, BMP, WEBP, SVG

### 视频

- MP4, AVI, MOV, WMV, FLV, MKV

### 音频

- MP3, WAV, OGG, AAC, FLAC

### 文档

- PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, TXT

### 其他

- ZIP, RAR, 7Z 等压缩文件
- 代码文件（JS, TS, CSS, HTML 等）

## 使用说明

### 1. 拖拽上传

将文件拖拽到上传区域即可开始上传

### 2. 点击上传

点击上传区域，在弹出的文件选择器中选择文件

### 3. 文件夹上传

点击"选择文件夹"按钮，选择整个文件夹进行上传

### 4. 查看文件

- **列表视图**: 显示详细的文件信息
- **网格视图**: 卡片式展示，适合图片预览

### 5. 筛选文件

使用顶部的筛选按钮，按文件类型筛选

### 6. 操作文件

- **预览**: 点击预览按钮查看文件（支持图片和 PDF）
- **下载**: 点击下载按钮下载文件
- **删除**: 点击删除按钮移除文件

### 7. 批量操作

- **批量下载**: 下载所有上传成功的文件
- **清空**: 清空所有文件

## 配置说明

### 最大大小

设置单个文件的最大大小限制（MB）

### 最大数量

设置可上传的最大文件数量

### 多文件上传

开启后可以同时选择多个文件上传

## 技术实现

### 核心技术

- **Element Plus Upload** - 基础上传组件
- **HTML5 File API** - 文件处理
- **Drag & Drop API** - 拖拽功能
- **FileReader API** - 文件读取和预览
- **Blob URL** - 文件预览 URL

### 文件夹上传

使用 `webkitdirectory` 属性实现文件夹选择：

```typescript
const input = document.createElement('input')
input.type = 'file'
input.webkitdirectory = true
input.multiple = true
```

### 上传模拟

当前版本使用模拟上传（前端处理），实际项目中需要：

```typescript
// 替换为真实的上传逻辑
const uploadToServer = async (file: File) => {
  const formData = new FormData()
  formData.append('file', file)

  const response = await fetch('/api/upload', {
    method: 'POST',
    body: formData
  })

  return response.json()
}
```

### 文件预览

- **图片**: 使用 `URL.createObjectURL()` 创建预览 URL
- **PDF**: 在新窗口打开
- **其他**: 提示不支持预览

## 最佳实践

### 1. 文件大小限制

根据服务器配置设置合理的文件大小限制

### 2. 文件类型限制

可以添加 `accept` 属性限制文件类型：

```vue
<el-upload accept="image/*,video/*" ... />
```

### 3. 错误处理

添加完善的错误处理机制：

- 文件大小超限
- 文件数量超限
- 上传失败重试
- 网络错误处理

### 4. 性能优化

- 大文件分片上传
- 上传队列管理
- 并发上传控制
- 断点续传

### 5. 安全性

- 文件类型验证（前端+后端）
- 文件大小验证
- 文件内容扫描（后端）
- 防止恶意文件上传

## 扩展功能

### 计划中的功能

- [ ] 大文件分片上传
- [ ] 断点续传
- [ ] 上传队列管理
- [ ] 图片压缩
- [ ] 视频转码
- [ ] 文件加密
- [ ] 云存储集成（OSS、S3）
- [ ] 文件分享链接
- [ ] 文件权限管理

## 常见问题

### Q: 如何限制上传文件类型？

A: 在 `el-upload` 组件上添加 `accept` 属性：

```vue
<el-upload accept=".jpg,.png,.pdf" />
```

### Q: 如何实现真实的文件上传？

A: 替换 `simulateUpload` 函数为实际的 API 调用

### Q: 文件夹上传在某些浏览器不工作？

A: `webkitdirectory` 属性在旧版浏览器可能不支持，建议提示用户升级浏览器

### Q: 如何实现大文件上传？

A: 使用分片上传技术，将大文件切分成小块逐个上传

### Q: 上传的文件存储在哪里？

A: 当前版本文件存储在浏览器内存中（Blob URL），实际项目需要上传到服务器

## 浏览器兼容性

- ✅ Chrome 90+
- ✅ Firefox 88+
- ✅ Safari 14+
- ✅ Edge 90+

**注意**: 文件夹上传功能需要现代浏览器支持

## 总结

文件上传模块提供了完整的文件上传和管理功能，包括：

1. ✅ 多种上传方式（拖拽、点击、文件夹）
2. ✅ 实时上传进度显示
3. ✅ 文件预览和下载
4. ✅ 灵活的视图切换
5. ✅ 详细的统计信息
6. ✅ 可配置的上传限制

适用于各种文件上传场景，可根据实际需求进行扩展和定制。
