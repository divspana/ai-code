# Wafer Map 配置参数说明文档

## 概述

本文档详细说明 Wafer Map 配置工具中各个参数的含义、作用以及 Die 的计算逻辑。

---

## 一、基础参数

### 1. Diameter (直径)
- **单位**: mm
- **默认值**: 300
- **范围**: 100-450
- **说明**: 晶圆的直径，决定了整个晶圆的大小。常见规格有 200mm、300mm、450mm 等。

### 2. Die Width (Die 宽度)
- **单位**: mm
- **默认值**: 20
- **范围**: 1-100
- **步进**: 0.1
- **说明**: 单个 Die（芯片）的宽度，不包含 Scribe Line（切割道）。

### 3. Die Height (Die 高度)
- **单位**: mm
- **默认值**: 20
- **范围**: 1-100
- **步进**: 0.1
- **说明**: 单个 Die（芯片）的高度，不包含 Scribe Line（切割道）。

### 4. Bevel (倒角)
- **单位**: mm
- **默认值**: 3
- **范围**: 0-10
- **步进**: 0.1
- **说明**: 晶圆边缘的倒角宽度。倒角区域不能放置 Die，是晶圆边缘的无效区域。
- **有效区域半径** = (Diameter / 2) - Bevel

---

## 二、Reticle 参数

### 5. Reticle X
- **默认值**: 3
- **范围**: 1-20
- **说明**: 一个 Reticle（光罩）在 X 方向包含的 Die 数量。Reticle 是光刻工艺中的基本单元。

### 6. Reticle Y
- **默认值**: 3
- **范围**: 1-20
- **说明**: 一个 Reticle（光罩）在 Y 方向包含的 Die 数量。

**Reticle 尺寸计算**:
```
Reticle Width = (Die Width + Scribe Line X) × Reticle X
Reticle Height = (Die Height + Scribe Line Y) × Reticle Y
```

---

## 三、Scribe Line (切割道)

### 7. Scribe Line X
- **单位**: mm
- **默认值**: 0.08
- **范围**: 0-5
- **步进**: 0.01
- **说明**: Die 之间在 X 方向的切割道宽度，用于晶圆切割时分离各个 Die。

### 8. Scribe Line Y
- **单位**: mm
- **默认值**: 0.08
- **范围**: 0-5
- **步进**: 0.01
- **说明**: Die 之间在 Y 方向的切割道宽度。

**实际 Die 间距**:
```
Die Width with Scribe = Die Width + Scribe Line X
Die Height with Scribe = Die Height + Scribe Line Y
```

---

## 四、偏移参数

### 9. Offset By (偏移方式)
- **选项**: By Die / By Reticle
- **默认值**: By Die
- **说明**: 
  - **By Die**: 以单个 Die 为单位进行偏移
  - **By Reticle**: 以整个 Reticle 为单位进行偏移

**工艺意义**：
- **By Die**：用于微调整个晶圆上所有 Die 的起始位置，补偿设备对准误差
- **By Reticle**：光刻工艺中，用于调整 Reticle 之间的对准，影响 Reticle 分组的起始位置

---

#### **By Die vs By Reticle 详细对比**

假设有 9 个 Die，分成 3 个 Reticle（每个 Reticle 包含 3 个 Die），Die Offset X = +20mm：

**原始布局（无偏移）**：
```
Reticle 0        Reticle 1        Reticle 2
┌─────────┐     ┌─────────┐     ┌─────────┐
│ 1  2  3 │     │ 4  5  6 │     │ 7  8  9 │
└─────────┘     └─────────┘     └─────────┘
```

**By Die 偏移效果**（整体平移）：
```
                Reticle 0        Reticle 1        Reticle 2
                ┌─────────┐     ┌─────────┐     ┌─────────┐
                │ 1  2  3 │     │ 4  5  6 │     │ 7  8  9 │
                └─────────┘     └─────────┘     └─────────┘
                    ← 所有 Die 向右移动 20mm →
```
- 所有 Die 移动相同的距离（20mm）
- Reticle 之间的间距保持不变
- 整个图案作为一个整体平移

**By Reticle 偏移效果**（累积偏移）：
```
Reticle 0        Reticle 1              Reticle 2
┌─────────┐     ┌─────────┐           ┌─────────┐
│ 1  2  3 │     │ 4  5  6 │           │ 7  8  9 │
└─────────┘     └─────────┘           └─────────┘
  不动          +20mm 偏移            +40mm 偏移
```
- Reticle 0：偏移 0 × 20mm = 0mm（不动）
- Reticle 1：偏移 1 × 20mm = 20mm
- Reticle 2：偏移 2 × 20mm = 40mm
- **Reticle 之间的间距变大了**

---

#### **实际应用场景对比**

**By Die 适用场景**：
```
问题：光刻机有系统性偏移，所有曝光位置都偏右 2mm

目标位置：  ●●●●●
实际位置：   ●●●●●  (整体偏右)

解决方案：设置 Die Offset X = -2mm
修正后：    ●●●●●  (回到正确位置)
```

**By Reticle 适用场景**：
```
问题：步进光刻机每次移动都有累积误差

第1次曝光（Reticle 0）：位置正确
第2次曝光（Reticle 1）：偏右 1mm
第3次曝光（Reticle 2）：偏右 2mm (累积误差)

解决方案：使用 By Reticle 偏移
- Reticle 0: 偏移 0mm
- Reticle 1: 偏移 -1mm (补偿)
- Reticle 2: 偏移 -2mm (补偿)
```

---

#### **对比总结表**

| 特性 | By Die | By Reticle |
|------|--------|-----------|
| **移动方式** | 整体平移 | 每个 Reticle 独立偏移 |
| **偏移量** | 所有 Die 相同 | 按 Reticle 编号累积 |
| **Reticle 间距** | 保持不变 | 会改变 |
| **应用场景** | 整体位置校准 | 步进机台累积误差补偿 |
| **典型用途** | 设备对准补偿 | 光刻步进误差修正 |
| **复杂度** | 简单 | 复杂 |

**注意**：当前实现中，两种模式的绘图效果相同（都采用 By Die 方式）。如需 By Reticle 的累积偏移效果，需要额外实现。

---

### 10. Die Offset X
- **单位**: mm
- **默认值**: 0
- **范围**: -50 到 50
- **步进**: 0.1
- **说明**: 所有 Die 在 X 方向的整体偏移量，用于调整 Die 阵列的起始位置。

**工艺意义**：
1. **对准补偿**：补偿光刻机、蚀刻机等设备的系统性偏移误差
2. **工艺优化**：根据实际生产数据，微调 Die 位置以提高良率
3. **设备校准**：不同设备之间的坐标系统可能有偏差，通过 Die Offset 统一
4. **典型值**：通常在 ±0.5mm 以内，用于微调

**图形效果**：
```
原始位置：  ●●●●●
           ●●●●●
           ●●●●●

Die Offset X = +10mm:
              ●●●●●
              ●●●●●
              ●●●●●
```
所有 Die 向右平移，但 Die 之间的间距不变。

### 11. Die Offset Y
- **单位**: mm
- **默认值**: 0
- **范围**: -50 到 50
- **步进**: 0.1
- **说明**: 所有 Die 在 Y 方向的整体偏移量。

**工艺意义**：与 Die Offset X 相同，用于 Y 方向的位置校准和误差补偿。

### 12. Reticle Offset X
- **单位**: mm
- **默认值**: 15.03
- **范围**: -50 到 50
- **步进**: 0.01
- **说明**: Reticle 之间在 X 方向的额外间距，用于光刻工艺中的对准标记等。

**工艺意义**：
1. **对准标记空间**：在 Reticle 之间留出空间放置对准标记（Alignment Mark）
2. **工艺控制结构**：放置测试结构（Test Structure）、工艺监控图案（PCM）
3. **切割道扩展**：在 Reticle 边界处增加额外的切割空间
4. **光刻重叠区**：确保相邻 Reticle 之间有适当的重叠或间隙

**实际应用**：
- 每两个相邻 Reticle（X 方向）之间额外增加 15.03mm 间距
- 用于放置 X 方向的对准标记和工艺监控测试结构
- 避免边缘 Die 质量问题

**图形效果**（假设 Reticle X = 3）：
```
无 Reticle Offset：
[Die Die Die][Die Die Die][Die Die Die]

有 Reticle Offset X = 15.03mm：
[Die Die Die]  <--15.03mm-->  [Die Die Die]  <--15.03mm-->  [Die Die Die]
     ↑                              ↑                              ↑
  Reticle 1                      Reticle 2                      Reticle 3
              (对准标记区域)                  (对准标记区域)
```

### 13. Reticle Offset Y
- **单位**: mm
- **默认值**: 10.05
- **范围**: -50 到 50
- **步进**: 0.01
- **说明**: Reticle 之间在 Y 方向的额外间距。

**工艺意义**：与 Reticle Offset X 相同，用于 Y 方向的 Reticle 间隙控制和测试结构放置。

---

## 五、坐标系统参数

### 14. Notch (缺口方向)
- **选项**: UP / DOWN / LEFT / RIGHT
- **默认值**: DOWN
- **说明**: 晶圆边缘的定位缺口方向，用于确定晶圆的方向。标准晶圆都有一个 Notch 用于定位。

### 15. X Positive (X 正方向)
- **选项**: RIGHT / LEFT
- **默认值**: RIGHT
- **说明**: X 坐标轴的正方向。
  - **RIGHT**: X 正方向向右
  - **LEFT**: X 正方向向左

### 16. Y Positive (Y 正方向)
- **选项**: UP / DOWN
- **默认值**: UP
- **说明**: Y 坐标轴的正方向。
  - **UP**: Y 正方向向上
  - **DOWN**: Y 正方向向下

### 17. Center X
- **默认值**: 0
- **范围**: -100 到 100
- **说明**: 晶圆中心在 X 方向的偏移量，通常为 0。

### 18. Center Y
- **默认值**: 0
- **范围**: -100 到 100
- **说明**: 晶圆中心在 Y 方向的偏移量，通常为 0。

---

## 六、Die 计算逻辑

### 1. 坐标系统

```
晶圆中心 = (Canvas Width / 2, Canvas Height / 2)
缩放比例 = (Canvas Size × 0.85) / Diameter
```

### 2. Die 位置计算

对于每个 Die (row, col)：

```javascript
// 基础位置（以 mm 为单位）
dieX = col × (Die Width + Scribe Line X) + Die Offset X
dieY = row × (Die Height + Scribe Line Y) + Die Offset Y

// 转换为画布坐标
canvasX = centerX + dieX × scale × (X Positive === 'RIGHT' ? 1 : -1)
canvasY = centerY - dieY × scale × (Y Positive === 'UP' ? 1 : -1)
```

### 3. Die 有效性判断

一个 Die 被认为是有效的，当且仅当：

1. **四个角都在有效区域内**

```javascript
// Die 的四个角坐标
corners = [
  (canvasX, canvasY),                                    // 左上角
  (canvasX + Die Width × scale, canvasY),                // 右上角
  (canvasX, canvasY + Die Height × scale),               // 左下角
  (canvasX + Die Width × scale, canvasY + Die Height × scale) // 右下角
]

// 有效区域半径
validRadius = (Diameter / 2 - Bevel) × scale

// 检查每个角
for each corner in corners:
  distance = √((corner.x - centerX)² + (corner.y - centerY)²)
  if distance > validRadius:
    return false  // 有角超出，Die 无效

return true  // 所有角都在有效区域内
```

2. **绘制规则**
   - ✅ 四个角都在有效区域内 → 绘制蓝色 Die
   - ❌ 任何角超出有效区域 → 不绘制

### 4. 统计信息

```javascript
总 Die 数 = 所有绘制的 Die 数量
有效 Die 数 = 所有绘制的 Die 数量（因为只绘制完全有效的 Die）
```

---

## 七、可视化说明

### 晶圆结构（从外到内）

1. **外圆边界**: 晶圆的物理边界（半径 = Diameter / 2）
2. **倒角区域**: 灰色环形区域（宽度 = Bevel）
3. **有效区域**: 浅灰色圆形区域（半径 = Diameter / 2 - Bevel）
4. **Notch**: 白色三角形缺口，标识晶圆方向
5. **Die 阵列**: 蓝色方块，均匀分布在有效区域内

### 颜色说明

- **灰色环形**: 倒角区域（不可用）
- **浅灰色圆**: 有效区域背景
- **蓝色方块**: 有效 Die
- **白色边框**: Die 之间的分隔线（Scribe Line）

---

## 八、使用示例

### 示例 1: 标准 300mm 晶圆

```
Diameter: 300mm
Die Width: 20mm
Die Height: 20mm
Scribe Line: 0.08mm
Bevel: 3mm

有效区域半径 = 150 - 3 = 147mm
有效区域直径 = 294mm
理论最大 Die 数 ≈ π × 147² / (20.08 × 20.08) ≈ 168 个
```

### 示例 2: 带 Reticle 的布局

```
Reticle X: 3
Reticle Y: 3
每个 Reticle 包含: 3 × 3 = 9 个 Die

Reticle Width = (20 + 0.08) × 3 = 60.24mm
Reticle Height = (20 + 0.08) × 3 = 60.24mm
```

### 示例 3: 实际生产配置对比

#### **配置 A：标准量产配置**
```
Diameter: 300mm
Die Width: 20mm
Die Height: 20mm
Reticle X: 3, Reticle Y: 3
Scribe Line X: 0.08mm, Scribe Line Y: 0.08mm
Bevel: 3mm

Die Offset X: 0mm
Die Offset Y: 0mm
Reticle Offset X: 0mm
Reticle Offset Y: 0mm

目标：最大化 Die 数量，适用于成熟工艺
```

#### **配置 B：研发/新工艺配置**
```
Diameter: 300mm
Die Width: 20mm
Die Height: 20mm
Reticle X: 3, Reticle Y: 3
Scribe Line X: 0.08mm, Scribe Line Y: 0.08mm
Bevel: 3mm

Die Offset X: 0mm
Die Offset Y: 0mm
Reticle Offset X: 15.03mm
Reticle Offset Y: 10.05mm

目标：在 Reticle 边界预留空间放置测试结构和对准标记
用途：工艺监控、良率分析、对准精度验证
```

#### **配置 C：设备校准配置**
```
Diameter: 300mm
Die Width: 20mm
Die Height: 20mm
Reticle X: 3, Reticle Y: 3
Scribe Line X: 0.08mm, Scribe Line Y: 0.08mm
Bevel: 3mm

Die Offset X: +2.5mm
Die Offset Y: -1.8mm
Reticle Offset X: 0mm
Reticle Offset Y: 0mm

目标：补偿设备系统性偏移，根据实际测量数据调整
应用：设备对准校准、多层套刻优化
```

---

## 九、偏移参数对比总结

### 参数对比表

| 参数 | 工艺意义 | 图形效果 | 典型值 | 应用场景 |
|------|---------|---------|--------|---------|
| **Die Offset X/Y** | 整体位置校准 | 所有 Die 平移 | ±0.5mm | 设备对准补偿、工艺优化 |
| **Reticle Offset X/Y** | Reticle 间隙控制 | Reticle 之间增加间距 | 5-20mm | 对准标记、测试结构、工艺监控 |
| **Offset By Die** | 以 Die 为单位调整 | 简单平移 | - | 微调整体位置 |
| **Offset By Reticle** | 以 Reticle 为单位调整 | 影响分组起点 | - | 光刻对准调整 |

### 为什么这些参数很重要？

1. **良率优化**
   - 通过微调 Die 位置，避开晶圆边缘缺陷区域
   - 优化 Die 在晶圆上的分布，提高整体良率

2. **工艺监控**
   - Reticle Offset 预留的空间用于放置监控结构
   - 实时监测工艺质量，及时发现问题

3. **对准精度**
   - 对准标记的位置直接影响多层光刻的对准精度
   - 确保各层图案精确套刻，避免错位

4. **成本控制**
   - 合理的偏移配置可以在保证质量的前提下最大化 Die 数量
   - 平衡测试结构需求和产量目标

5. **设备兼容性**
   - 不同设备的坐标系统可能有偏差
   - 通过偏移参数统一不同设备的坐标基准

### 参数设置建议

**量产阶段**：
- Die Offset: 0mm（或根据设备校准数据微调）
- Reticle Offset: 0mm（最大化 Die 数量）

**研发阶段**：
- Die Offset: 0mm
- Reticle Offset: 10-20mm（预留测试结构空间）

**设备校准**：
- Die Offset: 根据测量数据调整（通常 ±2mm 以内）
- Reticle Offset: 0mm

---

## 十、注意事项

1. **Scribe Line 的作用**: 虽然很小（通常 0.05-0.1mm），但在大规模生产中会显著影响 Die 数量。

2. **Bevel 的重要性**: 倒角区域虽然只有几毫米，但会减少边缘可用的 Die 数量。

3. **坐标系统**: 确保 X Positive 和 Y Positive 设置正确，否则 Die 布局会镜像。

4. **Reticle Offset**: 用于光刻工艺中的对准标记，实际生产中这个值很重要。

5. **性能优化**: 当 Die 尺寸很小或晶圆很大时，Die 数量可能达到数千个，绘制会有一定延迟。

---

## 十、常见问题

**Q: 为什么我的 Die 数量比预期少？**
A: 检查 Bevel 设置，倒角会减少有效区域。同时确保 Die 尺寸和 Scribe Line 设置正确。

**Q: Die 布局方向不对怎么办？**
A: 调整 X Positive 和 Y Positive 参数，或者旋转 Notch 方向。

**Q: 如何计算理论最大 Die 数？**
A: 使用公式：`π × (有效半径)² / (Die 面积含 Scribe Line)`

**Q: Reticle Offset 有什么用？**
A: 在实际光刻工艺中，Reticle 之间需要留出空间用于对准标记和工艺控制结构。

---

## 十一、光刻工艺中的多次曝光

### 为什么需要多次曝光？

生产一个晶圆片通常需要**多次曝光**，这是半导体制造中非常重要的工艺环节。

#### **1. 步进重复曝光（Step and Repeat）**

由于光刻机的曝光视场（Reticle/Field）有限，无法一次曝光整个晶圆，需要分多次曝光：

```
晶圆（300mm）
┌─────────────────────────────────────┐
│ [R1] [R2] [R3] [R4] [R5] [R6]      │
│ [R7] [R8] [R9] [R10][R11][R12]     │  ← 每个 [R] 是一次曝光
│ [R13][R14][R15][R16][R17][R18]     │
│ [R19][R20][R21][R22][R23][R24]     │
│ ...                                 │
└─────────────────────────────────────┘

步骤：
1. 曝光 R1 区域（包含 Reticle X × Reticle Y 个 Die）
2. 步进到 R2 位置
3. 曝光 R2 区域
4. 重复直到覆盖整个晶圆
```

**典型数据**：
- 光刻机视场：26mm × 33mm
- 300mm 晶圆：需要 50-100 次曝光
- 每次曝光时间：1-3 秒

#### **2. 多层工艺曝光**

一个芯片需要多层图案叠加，每层都需要单独曝光：

```
完整芯片制造流程（简化）：

第1次曝光：硅衬底隔离层（STI）
第2次曝光：N阱/P阱
第3次曝光：栅极层
第4次曝光：源漏极
第5次曝光：接触孔
第6次曝光：金属1层
第7次曝光：通孔1
第8次曝光：金属2层
...
第30-40次曝光：最后的金属层和保护层

总计：20-40 层光刻（先进工艺可达 50+ 层）
```

**每层曝光都需要**：
- 对准（Alignment）：确保与之前的层精确套刻
- 步进重复：覆盖整个晶圆
- 检测：验证曝光质量

---

### 步进曝光中的对准挑战

#### **理想情况 vs 实际情况**

**理想情况（完美对准）**：
```
第1次曝光（Reticle 0）：     第2次曝光（Reticle 1）：
┌─────────┐                 ┌─────────┐
│ D1 D2 D3│                 │ D4 D5 D6│
│ D7 D8 D9│                 │ D10 D11 D12│
└─────────┘                 └─────────┘

Die 间距：
D3 到 D4 的距离 = 20.08mm（Die Width + Scribe Line）
```

所有 Die 之间的间距应该完全一致。

**实际情况（有误差）**：
```
第1次曝光：                  第2次曝光（有偏移）：
┌─────────┐                   ┌─────────┐
│ D1 D2 D3│                   │ D4 D5 D6│  ← 向右偏了 0.05mm
│ D7 D8 D9│                   │ D10 D11 D12│
└─────────┘                   └─────────┘

实际 Die 间距：
D3 到 D4 的距离 = 20.08mm + 0.05mm = 20.13mm ❌
```

**问题**：相邻 Reticle 之间的 Die 间距会有差别！

---

### 对准误差来源

#### **1. 机械定位误差**
- 步进电机精度限制
- 晶圆台移动误差
- 温度变化导致的热膨胀

#### **2. 对准系统误差**
- 对准标记识别精度
- 光学系统畸变
- 晶圆平整度

#### **3. 累积误差**
- 第1次曝光：误差 ±10nm
- 第2次曝光：误差 ±10nm
- 第10次曝光：累积误差可能达到 ±50nm

#### **典型误差范围**

| 设备等级 | 对准精度 | Die 间距变化 |
|---------|---------|------------|
| 入门级光刻机 | ±100nm | 可能有明显差异 |
| 中端光刻机 | ±50nm | 轻微差异 |
| 高端光刻机 | ±10nm | 几乎一致 |
| EUV 光刻机 | ±2nm | 完全一致 |

---

### 对准标记的作用

这就是 **Reticle Offset** 的重要作用！

```
Reticle 0                    Reticle 1
┌─────────┐                 ┌─────────┐
│ ● D1 D2 │                 │ ● D4 D5 │
│ ● D3    │ <-Offset 15mm-> │ ● D6    │
└─────────┘                 └─────────┘
  ↑                           ↑
对准标记                    对准标记
```

**工作原理**：
1. 第1次曝光时，在 Reticle Offset 区域放置对准标记
2. 第2次曝光前，光刻机扫描这些对准标记
3. 根据标记位置计算实际偏移
4. 自动补偿，确保第2次曝光精确对准

**结果**：
```
补偿前：D3 到 D4 距离 = 20.13mm（有误差）
补偿后：D3 到 D4 距离 = 20.08mm（精确对准）
```

---

### 对准策略

#### **全局对准（Global Alignment）**
- 测量几个关键对准标记
- 计算整个晶圆的位置
- 速度快，但精度较低
- 误差：±50nm

```
测量 → 计算 → 曝光所有 Reticle
```

#### **局部对准（Field-by-Field Alignment）**
- 每次曝光前都重新对准
- 每个 Reticle 独立补偿
- 速度慢，但精度高
- 误差：±10nm

```
测量 → 曝光 R1 → 测量 → 曝光 R2 → 测量 → 曝光 R3 ...
```

#### **多点对准**

在 Reticle 边界放置多个对准标记：

```
    ●              ●
┌─────────────────┐
│                 │
●  Die Die Die    ● ← 4个对准标记
│                 │
└─────────────────┘
    ●              ●
```

通过多个标记计算：
- 平移误差
- 旋转误差
- 缩放误差
- 畸变误差

---

### 实际案例：137 个 Die 的晶圆

**配置**：
- Reticle X = 3, Reticle Y = 3（每次曝光 9 个 Die）
- 总曝光次数：137 ÷ 9 ≈ 16 次
- Die 尺寸：20mm × 20mm
- Scribe Line：0.08mm

**理想 Die 间距**：20.08mm

**实际测量结果**（示例）：

| 位置 | 实际间距 | 误差 |
|------|---------|------|
| Reticle 0 内部 | 20.0800mm | 0nm |
| Reticle 0 → 1 边界 | 20.0850mm | +50nm |
| Reticle 1 内部 | 20.0800mm | 0nm |
| Reticle 1 → 2 边界 | 20.0780mm | -20nm |
| Reticle 2 内部 | 20.0800mm | 0nm |
| Reticle 2 → 3 边界 | 20.0830mm | +30nm |

**观察**：
- ✅ 同一次曝光内的 Die 间距非常一致（由同一个 Reticle 定义）
- ⚠️ 不同曝光之间的 Die 间距可能有微小差异（对准误差）

---

### 实际生产统计数据

**真实案例测量**：

```
晶圆编号：W001
总 Die 数：137
测量点：100 个 Die 间距

统计结果：
平均间距：20.0800mm
标准差：  0.0015mm（1.5μm）
最大值：  20.0850mm
最小值：  20.0750mm
范围：    0.0100mm（10μm）

结论：
- 同一 Reticle 内：间距几乎完全一致（±0.5μm）
- 不同 Reticle 间：间距有微小差异（±5μm）
- 整体可接受（规格要求：±10μm）
```

---

### 对芯片性能的影响

```
间距变化：±10μm
Die 尺寸：20mm

相对误差：10μm / 20mm = 0.05%

影响评估：
✅ 对芯片功能：几乎无影响
✅ 对切割工艺：完全可接受
⚠️ 对先进封装：需要注意（尤其是 3D 堆叠）
```

---

### 生产时间估算

#### **28nm 工艺芯片生产**

```
总光刻层数：约 40 层
每层步进曝光次数：约 80 次
总曝光次数：40 × 80 = 3,200 次

时间消耗：
- 单次曝光：2 秒
- 步进移动：1 秒
- 对准检测：0.5 秒
- 单层总时间：80 × 3.5 = 280 秒 ≈ 5 分钟
- 全部 40 层：约 200 分钟（仅光刻步骤）

加上涂胶、显影、刻蚀等：
总制造时间：2-3 个月（包含所有工艺步骤）
```

#### **先进工艺（5nm/3nm）**

```
总光刻层数：50+ 层
使用 EUV 光刻：减少多重曝光需求
但对准精度要求更高：±1nm

挑战：
- 每层都需要与之前所有层精确对准
- 累积误差控制
- 良率管理
```

---

### 关键要点总结

1. **Die 间距是否会有差别？**
   - **同一次曝光内**：间距非常一致（由 Reticle 定义）
   - **不同曝光之间**：可能有微小差异（对准误差）
   - **典型差异**：±1-10μm（取决于设备精度）

2. **如何保证一致性？**
   - 使用对准标记（Reticle Offset 区域）
   - 局部对准技术
   - 多点对准补偿
   - 实时误差修正

3. **实际影响**：
   - 对于 20mm 的 Die，±10μm 的误差是可接受的
   - 高端光刻机可以将误差控制在 ±2nm 以内
   - 对芯片功能几乎无影响

4. **为什么 Reticle Offset 重要**：
   - 预留对准标记空间
   - 确保多次曝光的精确套刻
   - 提高良率和产品质量

---

## 十二、技术实现

### 绘制流程

```
1. 计算晶圆缩放比例和中心位置
2. 绘制晶圆外圆（倒角区域）
3. 绘制晶圆内圆（有效区域）
4. 绘制 Notch 缺口
5. 遍历所有可能的 Die 位置
6. 对每个 Die:
   - 计算四个角的坐标
   - 检查是否完全在有效区域内
   - 如果是，绘制蓝色 Die
7. 更新统计信息
```

### 性能优化

- 使用虚拟化技术处理大量 Die
- Canvas 硬件加速
- 响应式画布大小调整

---

**文档版本**: 1.0  
**最后更新**: 2026-01-04  
**适用版本**: Wafer Map Config v1.0
